# Новости Qt, май 2018 - декабрь 2018

Очередной сборник новостей Qt, на этот раз за последние полгода с [прошлой статьи](/post/354972). Релизы 5.11 и 5.12, реинкарнация PySide, внезапные похороны Qbs, выход Qt Design Studio и значительное улучшение условий лицензий для стартапов.

![ДДПВ](https://habrastorage.org/webt/yi/jl/mn/yijlmn6hjzvihibrburqqunvcjc.jpeg)
<cut />
Интересной КПДВ я не придумал, потому вместо неё просто ДДПВ - это к нам летом в офис приходил фотограф на корпоративную фотосессию, из которой я и подрезал фотку коллеги.

Начнём с нарушенных обещаний. В конце предыдущей статьи были размещены два голосования: за перевод [поста из официального блога](http://blog.qt.io/blog/2018/05/03/qt-microncontrollers-mcu/) про портирование Qt на микроконтроллеры и за написание обзора [Safe Renderer](https://doc.qt.io/QtSafeRenderer/qtsr-overview.html), и голосование показало, что обе статьи заслуживают публикации. Но в размещении микроконтроллерной статьи НЛО автору отказало: "*Публикации рекламного характера вне корпоративного блога и хаба «Я пиарюсь» запрещены правилами сайта*". Сложно сказать, что именно там было рекламного (*можете посмотреть английский оригинал и оценить*), но в таком случае про Safe Renderer не было даже и смысла пытаться (*потому что это исключительно коммерческая фича*). Так что простите, если кто ждал.

Содержание на сегодня:

- [Новые релизы](#releases)
    + [Qt 5.11](#qt511)
    + [Qt 5.12](#qt512)
- [Обновления инструментов](#tools)
    + [Qt Creator 4.8](#qtc)
    + [Qt Design Studio 1.0](#qds)
    + [Qt 3D Studio 2.2](#q3ds)
- [Анонс Kuesa](#kuesa)
- [Релиз PySide / Qt for Python](#pyside)
- [Дальнейшее портирование на MCU](#mcu)
- [Отказ от Qbs](#qbs)
- [Изменения в коммерческом лицензировании](#license)
- [Другие новости](#other)

## <anchor>releases</anchor>Новые релизы

### <anchor>qt511</anchor>Qt 5.11

22 мая [вышел Qt 5.11](http://www.opennet.ru/opennews/art.shtml?num=48641).

Не могу выделить какие-то особо значительные нововведения, кроме [переработанного](http://blog.qt.io/blog/2018/05/22/optimizing-qml-compiler-pipeline/) процесса компиляции QML, который должен существенно улучшить производительность Qt Quick приложений:

![QML compiler pipeline](https://habrastorage.org/webt/x1/ar/hf/x1arhfv61fl36j0ya7n_rxh-kn0.png)

Также в релизе:

* поддержка High-DPI для Qt Widgets на Windows (*до этого было только в Mac OS и Linux*);
* поддержка [сжатых текстур в Qt Quick](https://blog.qt.io/blog/2018/05/07/compressed-textures-in-qt-5-11/);
* превью реализации коммуникационного протокола [OPC UA](https://blog.qt.io/blog/2018/05/16/opc-ua-support-qt-5-11/);
* превью [Qt for WebAssembly](http://blog.qt.io/blog/2018/05/22/qt-for-webassembly/). <strike>Но зачем.</strike>

### <anchor>qt512</anchor>Qt 5.12

6 декабря [вышел Qt 5.12](http://www.opennet.ru/opennews/art.shtml?num=49731) (*[обзор от CTO](https://youtu.be/IDMvhb0GOFs)*), очередной LTS релиз, который будет поддерживаться 3 года. 

[Улучшена производительность](http://blog.qt.io/blog/2018/11/16/qt-quick-performance-improvements-qt-5-12-lts/). В основном это касается движка QML и JavaScript, который теперь [соответствует стандарту ECMAScript 7](https://bugreports.qt.io/browse/QTBUG-47735).

Релиз [Qt Remote Object](https://doc.qt.io/qt-5.11/qtremoteobjects-gettingstarted.html) - механизма межпроцессорного взаимодействия как на одном хосте, так и между разными хостами по сети.

Релиз [Qt Quick WebGL](http://blog.qt.io/blog/2018/11/23/qt-quick-webgl-release-512/), он же Qt WebGL streaming - то есть возможность транслировать GUI приложения, работающего на удалённом хосте (*устройстве без дисплея*), и отображать его в браузере на десктопе или планшете. Как пример - Raspberry Pi с камерой, Qt-приложение стримит GUI вместе с выводом камеры, а рендерится всё в обычном Safari на iPad:

![Qt Quick WebGL](https://habrastorage.org/webt/sp/zg/-l/spzg-lohcrc74m4xtfhjjcbrdh8.jpeg)

Очень прикольная штука, я прямо восторгом с ней поигрался, но откровенно говоря я не представляю, кто и зачем будет этим пользоваться. Если и так подразумевается работа с девайсом из браузера, то зачем городить GUI на Qt Quick и стримить его в WebGL? Не проще ли тогда просто запустить на девайсе нормальный веб-сервер, а GUI на клиенте будет с HTML/CSS/JS без вот этого всего? Странная фича, в общем.

В Qt Quick Controls 2 наконец-то добавили [TableView](https://doc.qt.io/qt-5.12/qml-qtquick-tableview.html). Вот даже [сравнение](http://blog.qt.io/blog/2018/12/20/tableview-performance/) производительности аналога из Qt Quick Controls 1. К сожалению, по-прежнему никаких новостей про [TreeView](https://bugreports.qt.io/browse/QTBUG-61630).

Pointer Handlers вышли из статуса превью и переименовались в [Input Handlers](https://doc.qt.io/qt-5/qtquickhandlers-index.html). Это новый модуль для обработки ввода с мыши, клавиатуры и тачскрина. В связи с этим в какой-то момент следует ожидать "устаревания" [MouseArea](https://doc.qt.io/qt-5/qml-qtquick-mousearea.html).

В [Qt Virtual Keyboard](http://doc.qt.io/qt-5/qtvirtualkeyboard-index.html) помимо прочего добавлены новые языки а также новый движок рукописного ввода - [MyScript](http://blog.qt.io/blog/2018/11/28/handwriting-essential-input-method-successful-user-experience/).

В Qt for Device Creation появились так называемые [Qt Board Support Packages](https://doc.qt.io/QtForDeviceCreation/qtdc-qbsp.html). Это те же самые Yocto образы и тулчейны, только теперь в виде отдельно загружаемых и подключаемых к установщику пакетов. Смысл QBSP [заключается](http://blog.qt.io/blog/2018/12/14/board-support-package-commercial-build-enablers-qt-partners/) в поддержке партнёров-вендоров железа, чтобы им было удобнее создавать и распространять Boot to Qt образы для своих устройств.

Развивается поддержка [Wayland](http://blog.qt.io/blog/2018/12/14/whats-new-wayland-platform-plugin-qt-5-12/).

## <anchor>tools</anchor>Обновления инструментов

### <anchor>qtc</anchor>Qt Creator

За полгода вышло две версии Qt Creator: [4.7](http://www.opennet.ru/opennews/art.shtml?num=48987) и [4.8](http://www.opennet.ru/opennews/art.shtml?num=49731).

Из наиболее значимых нововведений - поддержка [Language Server Protocol](https://en.wikipedia.org/wiki/Language_Server_Protocol), то есть возможность расширения Qt Creator для работы с б*о*льшим количеством языков программирования. В то же время, "родной" QML до сих пор не в курсе последних версий модулей для импорта, из-за чего их приходится перебирать научным тыком.

В версии 4.8 также должен был быть добавлен [модуль телеметрии](https://bugreports.qt.io/browse/QTCREATORBUG-20250), но в этот релиз он не попал, так что ожидайте в 4.9.

### <anchor>qds</anchor>Qt Design Studio

Тот самый [полусекретный проект](https://habr.com/post/354972/#anchordsanchorqt-design-studio):

* [официальный анонс](http://blog.qt.io/blog/2018/06/26/qt-design-studio-the-new-age-of-ui-development/);
* [релиз](http://www.opennet.ru/opennews/art.shtml?num=49499).

Как вы знаете, в составе Qt есть прекрасный инструмент для создания GUI на Widgets - [Qt Designer](http://doc.qt.io/qt-5/qtdesigner-manual.html). С ним можно работать как из Qt Creator (*вкладка Design*), так и запустив его как самостоятельное приложение для работы с `.iu` файлами.

С появлением Qt Quick добавился инструмент [Qt Quick Designer](http://doc.qt.io/qtcreator/creator-using-qt-quick-designer.html), который уже нельзя запустить как отдельное приложение, так как он насмерть прибит гвоздями к Qt Creator.

И вот [Qt Design Studio](https://doc.qt.io/qtdesignstudio/index.html) - это тот же самый Qt Quick Designer, но с дополнительным функционалом. Также это теперь самостоятельное приложение, хотя по факту это просто покалеченная копия Qt Creator, которая запускается сразу в режиме дизайна Qt Quick (*с возможностью переключения в режим редактирования QML*).

* [рекламный ролик](https://youtu.be/EgjCvZWEPWk);
* [краткий обзор](https://youtu.be/kVdQ0V8mJE4);
* [пример работы с проектом](https://youtu.be/aV6kFxH3Xws).

Из нового функционала: линия времени для работы с анимациями, удобные диалоги для настройки этих анимаций и компонент live-preview для предпросмотра изменений на лету как в отдельном окне, так и на присоединённом планшете или другом устройстве. Примечательно, что все эти вещи вряд ли когда-нибудь попадут обратно в Qt Quick Designer.

Qt Design Studio предназначена для дизайнеров, и подразумевается, что они будут создавать в ней дизайн приложения, передавать результат (*`.ui.qml` файлы*) разработчикам, а разработчики будут работать с ними в полноценном Qt Creator.

Также ведётся разработка плагинов для существующих популярных инструментов дизайна, чтобы дизайнеры могли экспортировать свои наработки из этих инструментов в QML. Первым был создан плагин для [Adobe Photoshop](https://www.adobe.com/products/photoshop.html), следующим ожидается плагин для [Sketch](https://www.sketchapp.com), затем [Adobe XD](https://www.adobe.com/products/xd.html) и другие.

Я не дизайнер, потому мне сложно оценить полезность Qt Design Studio. Когда в Qt были только Widgets, я с плохо скрываемым удовольствием работал в Qt Designer, это отличный инструмент для создания GUI и по сей день. Когда появился Qt Quick, я несколько раз пытался пользоваться Qt Quick Designer, но в итоге бросил и просто пишу QML, для меня так удобнее и быстрее. А так как Qt Design Studio это почти что и есть Qt Quick Designer, то лично я ей пользоваться буду вряд ли. В то же время, насколько мне известно, ряд дизайнерских агентств, которые получили Qt Design Studio на "тест-драйв", отзываются о ней положительно.

В плане лицензирования инструмент вроде как заявлен в Open Source (*GPLv3*), но в то же время вроде как для распространения результатов работы требуется коммерческая лицензия. Да и просто загрузить установщик не так-то просто, требуется наличие [Qt Account](https://account.qt.io/). В общем, менеджеры продукта пока ещё не совсем определились.

### <anchor>q3ds</anchor>Qt 3D Studio

Продолжается развитие [Qt 3D Studio](https://doc.qt.io/qt3dstudio/qt3dstudio-index.html). За это время вышли версии [2.0](http://blog.qt.io/blog/2018/06/26/qt-3d-studio-2-0-released/) ([более подробный обзор](http://blog.qt.io/blog/2018/06/27/whats-qt-3d-studio-scene/)), [2.1](http://blog.qt.io/blog/2018/10/01/qt-3d-studio-2-1-released/) и [2.2](http://blog.qt.io/blog/2018/12/13/qt-3d-studio-2-2-released/).

Наиболее значительно изменение - переход с движка оригинальной NVIDIA DRIVE Design Studio на собственный движок на основе Qt 3D и значительное [улучшение производительности](http://blog.qt.io/blog/2018/12/19/qt-3d-studio-performance-improvements/).

Также был обозначен план объединения Qt 3D Studio и Qt Design Studio в единый инструмент, то есть вместо двух это будет одно приложение для работы с 2D и 3D.

## <anchor>kuesa</anchor>Анонс Kuesa

Говоря о 3D, тут KDAB выпустили своё решение для работы с 3D - [Kuesa](https://www.kdab.com/kdab-releases-kuesa-for-3d-asset-creation-and-integration-workflow/).

В отличие от Qt 3D Studio, они не стали тратить ресурсы на собственный инструмент для 3D моделирования, а позволяют дизайнерам работать с их привычными инструментами (*3DS Max, Blender*), и далее разработчик может использовать экспортированные [glTF](https://en.wikipedia.org/wiki/GlTF) модели в Qt. Для удобства в наличии также есть приложение для предпросмотра модели и наименований компонентов, чтобы разработчик знал как к ним обращаться у себя в коде, не открывая модель в оригинальном 3D редакторе.

На мой взгляд Kuesa является конкурирующим Qt 3D Studio решением (*и судя по всему, более удачным*), и это досадно, потому что вместо того, чтобы параллельно заниматься одним и тем же, эти усилия можно было бы потратить на что-то более полезное (*я сейчас не обязательно про KDAB*). Тут кстати будет напомнить что сам Qt 3D это тоже [вклад KDAB](http://blog.qt.io/blog/2016/06/16/introducing-qt-3d/).

## <anchor>pyside</anchor>Релиз PySide2 / Qt for Python

[PySide](https://wiki.qt.io/PySide) вернулся, переименовался сначала в [PySide2](https://wiki.qt.io/Qt_for_Python), а потом в скучный [Qt for Python](https://www.qt.io/qt-for-python).

[Первый релиз](http://blog.qt.io/blog/2018/06/13/qt-python-5-11-released/) вышел с Qt 5.11, но он всё ещё не считался за полноценный, а вот буквально на днях выпустили уже [официальный релиз](http://blog.qt.io/blog/2018/12/18/qt-python-5-12-released/) вместе с Qt 5.12.

Вряд ли я могу рассказать здесь что-то новое. Как и раньше, PySide - это возможность использовать Qt (*в основном, для GUI*) из Python. Распространяется через [PyPI](https://pypi.org/project/PySide2/), то есть в состав официального установщика Qt не входит, и устанавливается отдельно через `pip`. Поддержка на embedded платформах пока отсутствует, хотя и запланирована.

Списка отличий от [PyQt](https://riverbankcomputing.com/software/pyqt/intro) нет, хотя разработчики и заверяют, что PySide почти ни в чём не уступает, а скоро будет ещё и превосходить. С точки зрения коммерческого лицензирования, с PySide "всё включено" в стоимость лицензии Qt без дополнительной платы, а с PyQt надо ещё платить в Riverbank; с точки зрения Open Source, PySide доступен как под GPLv3, так и под LGPLv3, в то время как PyQt доступен только под GPLv3.

## <anchor>mcu</anchor>Дальнейшее портирование на MCU

Продолжается работа над портированием Qt на железо уровня микроконтроллеров. Помимо [RTEMS](https://www.rtems.org) были опробованы [FreeRTOS](https://www.freertos.org) (*которая стала выглядеть чуть получше после того как Amazon добавил туда некоторую поддержку POSIX*) и [uClinux](http://www.uclinux.org), и пока вывод такой, что мы всё-таки рекомендуем именно RTEMS.

Говоря о конкретных устройствах, помимо [STM32F4/F7](https://www.st.com/en/microcontrollers/stm32f7-series.html?querycriteria=productId=SS1858) удалось достичь хороших результатов на [NXP i.MX RT1050](https://www.nxp.com/products/processors-and-microcontrollers/arm-based-processors-and-mcus/i.mx-applications-processors/i.mx-rt-series/i.mx-rt1050-crossover-processor-with-arm-cortex-m7-core:i.MX-RT1050).

## <anchor>qbs</anchor>Отказ от Qbs

Топ 10 предательств в аниме! Вероломно, без объявления войны, в официальном блоге [было заявлено](http://blog.qt.io/blog/2018/10/29/deprecation-of-qbs/) об отказе от [Qbs](http://doc.qt.io/qbs/).

Вкратце: разработка Qbs прекращается, хотя и будет выпущен ещё один релиз, поддержка закончится в конце 2019 года, qmake пока останется, но в перспективе (*Qt 6*) будет осуществлён переход на CMake как основную систему сборки.

Пост собрал две сотни комментариев (*рекорд для нашего блога*), и собрал бы больше, но комментарии к постам автоматически закрываются через две недели после публикации. Вот [тут](http://www.opennet.ru/opennews/art.shtml?num=49519) ещё есть комментарии на русском.

Опуская техническое обоснование решения, основное возмущение вызвал тот факт, что несколько лет сообществу твердили о том как Qbs прекрасен и какой это шаг вперёд, не говоря уже о заверениях что это будет официальная система сборки в Qt 6 и всем надо на неё переходить (*и народ таки начал переходить*), и тут вдруг Qbs закрывается таким стремительным домкратом.

## <anchor>license</anchor>Изменения в коммерческом лицензировании

Коммерческое [лицензионное соглашение](https://www.qt.io/terms-conditions/) обновилось до версии 4.1. Добавился аппендикс с перечислением лицензируемого/распространяемого ПО.

Значительно улучшились условия [лицензии для стартапов](https://www.qt.io/start-up-plan/): во-первых, она теперь не со скидкой, а **вообще полностью бесплатная**, а во-вторых, теперь доступны компоненты и из Device Creation тоже (*готовые образы на основе Yocto Linux, тулчейны для кросс-компиляции и т.д.*), однако для распространения продуктов-устройств рантаймы покупать всё равно потребуется (*логика такая, что если есть деньги на железо, то должны найтись и на рантаймы*).

Лицензия для стартапов выдаётся на год и потом может быть продлена ещё на год. Юридически это полноценная коммерческая лицензия без необходимости выполнять требования GPL/LGPL. После первого года (*или двух*) она превращается в обычную лицензию за полную стоимость.

У стартапных лицензий действуют следующие ограничения:

* годовой доход компании должен быть меньше 100 000 долларов, иначе вы не квалифицируетесь как стартап;
* получить лицензии можно максимум на 3 разработчиков;
* техническая поддержка сильно урезана: 5 тикетов в месяц и низкий приоритет в очереди.

Кстати, не исключено, что вашу заявку на стартапную лицензию будет рассматривать как раз девушка с обложки статьи.

## <anchor>other</anchor>Другие новости

В этом году [Qt World Summit](https://www.qt.io/qtws18/home/) прошёл два раза: Бостоне и потом в Берлине. Записей выступлений пока нет, есть только короткий [видео-обзор](https://youtu.be/qSGVv0HFcIM) берлинского и [пост от KDAB](https://www.kdab.com/kdab-demos-at-qt-world-summit-berlin/).

Грядёт обновление иконок приложений:

![Новые иконки Qt](https://habrastorage.org/webt/ot/kd/wk/otkdwkxvc37ezdirezdovnc-y2w.png)

Как вам? Мне тоже. А главное, откуда опять эта нужда в редизайне, не так давно был уже один, и довольно неплохой.

Компания Forrester провела [исследование](https://www.qt.io/forrester-tei), в котором изучила влияние Qt на бизнес, всякие там ROI показатели и прочее. Вроде как это должно помочь компаниям оценить пользу от Qt и принять решение о приобретении коммерческой лицензии. Есть даже [онлайн-калькулятор](https://www.qt.io/roi-calculator) для подсчёта сэкономленных попугаев.

На этом с новостями пока всё, следующий выпуск будет где-нибудь в мае или как наберётся достаточно материала.
